<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hide a Message — Image Steganography</title>
  <meta name="description"
    content="Embed a secret message into a JPEG image. Upload a cover image, enter your message and password, download the stego image. Password-protected.">
  <meta name="author" content="Gaurav Subedi">
  <link rel="canonical" th:href="${requestUrl}">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Hide a Message — Image Steganography">
  <meta property="og:description"
    content="Embed a secret message into a JPEG image. Password-protected, visually undetectable.">
  <meta property="og:url" th:content="${requestUrl}">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hide a Message — Image Steganography">
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&display=swap"
    rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link th:href="@{/css/app.css}" rel="stylesheet">
</head>

<body class="page-container">
  <div class="container" style="max-width: 520px;">
    <div class="page-header">
      <div class="page-nav-actions">
        <a th:href="@{/}" class="btn btn-link btn-sm page-nav-link px-0">&larr; Back</a>
      </div>
      <h1 class="page-title mb-1">Hide a Message</h1>
      <p class="page-subtitle">Embed a secret message into an image. Output is a standard JPEG.</p>
    </div>

    <div id="errorContainer">
      <div th:if="${error}" class="alert alert-danger mb-3" th:text="${error}"></div>
    </div>

    <div class="card form-card">
      <div class="card-body">
        <form id="encodeForm" th:action="@{/encode}" method="post" enctype="multipart/form-data">
          <div class="mb-4">
            <label for="coverImage" class="form-label fw-medium">Cover Image</label>
            <input type="file" class="form-control" id="coverImage" name="coverImage" accept="image/*" required>
            <img id="imagePreview" class="image-preview border rounded mt-2" alt="Preview">
            <div class="form-text mt-1">JPEG, PNG, or BMP. Cropped to 8×8 block boundaries.</div>
          </div>

          <div class="mb-4">
            <label for="message" class="form-label fw-medium">Secret Message</label>
            <textarea class="form-control" id="message" name="message" rows="4" placeholder="Enter your secret message…"
              required></textarea>
            <div class="form-text mt-1">
              <span id="byteCount">0</span> / <span id="capacityDisplay">—</span> bytes
              <span id="overCapacity" class="text-danger fw-medium" style="display:none;"> (exceeds
                capacity)</span>
            </div>
          </div>

          <div class="mb-4">
            <label for="password" class="form-label fw-medium">Password</label>
            <input type="password" class="form-control" id="password" name="password"
              placeholder="Required to extract later" required>
          </div>

          <div class="mb-4">
            <label for="quality" class="form-label fw-medium">
              JPEG Quality: <span id="qualityValue" class="badge bg-primary">80</span>
            </label>
            <input type="range" class="form-range" id="quality" name="quality" min="1" max="100" value="80">
            <div class="form-text mt-1">Higher = larger file, lower = more compression.</div>
          </div>

          <button type="submit" id="submitBtn" class="btn btn-primary w-100 py-2">
            <span class="btn-content">Encode & Download</span>
            <span class="btn-loading-content" style="display: none;">
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Encoding…
            </span>
          </button>
        </form>
      </div>
    </div>
  </div>

  <script th:src="@{/js/encode.js}"></script>
</body>

</html>
